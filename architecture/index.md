# Концептуальная архитектура платформы Smartactors

Версия 0.0.1

## Введение

Данный документ представляет собой верхнеуровневое описание 
платформы Smartactors, реализующей принципы  
[акторной модели](https://ru.wikipedia.org/wiki/%D0%9C%D0%BE%D0%B4%D0%B5%D0%BB%D1%8C_%D0%B0%D0%BA%D1%82%D0%BE%D1%80%D0%BE%D0%B2).

## Общая архитектура платформы

Платформа Smartactors реализована на языке Java (поддерживается 
версия Java SE Version 8).

Платформа Smartactors состоит из основного серверного приложения,
набора модулей ядра, набора системных модулей и набора модулей, 
реалшизующих пользовательскую функциональность.

![Basic Architecture](pic1.png "Базовая архитектура платформы")

Развернутая платформа представляет собой каталог, содержащий 
файлы server.jar, configuration.json, а так же каталоги core, 
corefeatures и features. 

Соответственно, основной модуль платформы - приложение server.jar - 
запускается посредством Java-машины.

Файл configuration.json содержит конфигурации базовых объектов 
и цепочек платформы.

Каталог core содержит все модули ядра платформы.

Каталог corefeatures содержит только те системные модули 
платформы, которые необходимы для реализации пользовательской 
функциональности. 

corefeatures может содержать только один файл features.json, 
вмещающий описания и ссылки на необходимые системные модули. В 
таком случае, эти системные модули будут автоматически загружены 
сервером платформы при старте.

Каталог features содержит набор прикладных модулей, реализующих 
пользовательскую функциональность.

## Основные принципы платформы

### Модульность

Каждый отдельный самостоятельный блок пользовательской 
функциональности должен быть реализован в виде отдельного модуля
(feature). Модуль состоит из набора акторов, плагинов и файла 
конфигурации config.json. Акторы реализуют собственно 
пользовательскую функциональность. Плагины проводят начальную 
инициализацию акторов при загрузке модуля и регистрацию 
необходимых компонент. Файл конфигурации config.json содержит 
описания объектов модуля, цепочек модуля и др.

### Стратегии

Любая единица функциональности (в том числе акторы, создание 
объектов, обработка объекта некоторым способом) регистрируется 
в системном сервис-локаторе (IOC) в виде стратегии под 
соответствующим именем. Для вызова этой функциональности 
производится запрос к IOC на выполнение соответствующией 
стратегии. Таким образом поведение кода может динамически 
меняться путем замены/перерегистрации стратегии без изменения
самого кода.


### Принципы именования классов/интерфейсов/стратегий

Имена классов платформы должны начинаться с заглавной буквы и 
соответствовать "верблюжьей" нотации. Имена должны состоять 
**_только_** из существительных (и, может быть, предлогов) и 
представлять собой осмысленную фразу на английском языке в 
соответствии с его грамматикой. 

Имена интерфейсов должны начинаться с буквы "I" перед заглавной 
буквой первого слова имени.

Имена стратегий должны представлять из себя осмысленное описание 
выполняемого действия на английском языке. Все слова должны 
начинаться с маленькой буквы и быть разделенными пробелами. 
Например: "factor choice strategy" или "my main object creation".
Имя стратегии не должно состоять из более чем 4-6 слов.

## Начало работы с платформой

Для начала работы со Smartactors требуется установить пакет das,
позволяющий производить основные действия с платформой, такие 
как: создание сервера, установка ядра, 
создание/изменение/удаление пользовательских 
модулей/акторов/плагинов, и т.д.

Более подробную документацию по типовым действиям с платформой 
и das можно найти в разделе 
[Quickstart guides](../quickstart/).

## Структура проектов платформы

Платформа Smartactors представляет собой несколько 
maven-проектов: 
* Servers/Server2 содержит основное серверное приложение
* ServerDevelopmentTools содержит основной интерфейс
серверного приложения
* СoreFeatures содержит все модули ядра и системные модули
* CommonFeatures содержит модули с дополнительной 
функциональностью общего назначения
* SystemActors содержит дополнительные системные модули
* ServerPack содержит конфигурационный файл со списком всех 
модулей, входящих в ядро

## Архитектура ядра

Архитектура ядра платформы представлена следующей диаграммой

![Core Architecture](pic2.png "Архитектура ядра платформы")

Таблица со списком модулей ядра и их кратким описанием

| | Модуль | Описание | Зависимости | 
| ---: | :--- | --- | --- | 
| 1 | base | Модуль содержит базовые интерфейсы платформы | -- | 
| 2 | class-management | Модуль реализует систему управления модулями, загрузчик классов платформы и систему компиляции классов на лету. | base | 
| 3 | feature-loading-system | Модуль обеспечивает загрузку классов модулей платформы и упорядоченный запуск плагинов модулей в соответствии с их зависимостями. | base | 
| 4 | scope | Модуль реализует поддержку скоупов на платформе. | base | 
| 5 | scope-plugins | Модуль содержит плагины, инициализирующие функциональность скоупов. | base, feature-loading-system, scope, ioc |    
| 6 | iobject | Модуль содержит интерфейсы и их реализацию для работы с json-объектами. | base | 
| 7 | iobject-plugins | Модуль содержит плагины, регистрирующие в ioc стратегии работы с json-объектами. | base, iobject, feature-loading-system, ioc |    
| 8 | iobject-extension | Модуль содержит дополнительные реализации интерфейсов для работы с json-объектами.  | base, iobject, ioc |    
| 9 | iobject-extension-plugins | Модуль содержит плагины, регистрирующие в ioc дополнительные стратегии работы с json-объектами. | base, iobject-extention, feature-loading-system, ioc |    
| 10 | ioc | Модуль реализует функциональность системного сервис-локатора. | base, iobject, scope |
| 11 | ioc-plugins | Модуль содержит плагины, инициализирующие системный сервис-локатор. | ioc, feature-loading-system | 
| 12 | ioc-strategy-pack | Модуль содержит дополнительные стратегии для работы системного сервис-локатора. |  base, iobject, ioc | 
| 13 | ioc-strategy-pack-plugins | Модуль содержит плагины, регистрирующие дополнительные стратегии для работы с системным сервис-локатором. | base, feature-loading-system, ioc, ioc-plugins  | 
| 14 | message-processing-interfaces |  |  | 
| 15 | message-processing | | |
| 16 | message-processing-plugins ||| 
| 17 | dumpable-interface |||
| 18 | configuration-manager ||| 
| 19 | configuration-manager-plugins ||| 
| 20 | feature-management |||
| 21 | task |||
| 22 | task-plugins.non-blocking-queue ||| 
| 23 | core-service-starter |||
| 24 | field |||
| 25 | field-plugins ||| 
| 26 | on-feature-loading-service-starter ||| 
| 27 | shutdown |||
| 28 | shutdown-plugins ||| 
| 29 | version-management ||| 
| 30 | version-management-plugins ||| 

## Архитектура системного слоя

Архитектура системного слоя платформы представлена следующей 
диаграммой

Таблица со списком системных модулей и их кратким описанием

| | Модуль | Описание | Зависимости | 
| ---: | :--- | --- | --- | 
| 1 | endpoint | | |
| 2 | | | |
| 3 | | | |

## Подробное описание модулей ядра и системных модулей

